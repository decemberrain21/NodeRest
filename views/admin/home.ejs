<style type="text/css">
	.mr_b {
		margin-bottom: -10%;
	}
</style>
<link rel="stylesheet" href="/morris/morris.css" />
<div class="page-content">
	
	
	<div class="row mr_b">
		<div class="col-sm-6">
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter">
						<i class="icon-file green"></i>
						HR Activity
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

					<div class="widget-body">
						<div class="widget-main no-padding">
							<div class="space-6"></div>
							<div class="col-sm-12 infobox-container">
								<div class="infobox infobox-green  ">
									<div class="infobox-icon">
										<i class="icon-envelope"></i>
									</div>

									<div class="infobox-data">
										<span class="infobox-data-number"><%= dashboard["hr_msg_sent"]%></span>
										<div class="infobox-content">messages sent</div>
									</div>
									
								</div>

								<div class="infobox infobox-blue ">
									<div class="infobox-icon">
										<i class="icon-question"></i>
									</div>

									<div class="infobox-data">
										<span class="infobox-data-number"><%= dashboard["hr_q_sent"]%></span>
										<div class="infobox-content">survey questions sent</div>
									</div>
									
								</div>
						

								<div class="infobox infobox-orange2">
									<div class="infobox-icon">
										<i class="icon-user"></i>
									</div>

									<div class="infobox-data">
										<span class="infobox-data-number"><%= dashboard["hr_u_involved"] %></span>
										<div class="infobox-content">number of messages*users involved</div>
									</div>
								</div>

								<div class="space-6"></div>

					
							</div>
						</div><!-- /widget-main -->
					</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		<div class="space-6"></div>
		</div>
		<div class="col-sm-6">
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter">
						<i class="icon-user pink"></i>
						User Activity
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main no-padding">
					<div class="space-6"></div>
						<div class="col-sm-12 infobox-container">
				<div class="infobox infobox-blue2">
					<div class="infobox-progress">
						<div class="easy-pie-chart percentage" data-percent="<%= dashboard["a_percent"] %>" data-size="46">
							<span class="percent"><%= dashboard["a_percent"] %></span>%
						</div>
					</div>

					<div class="infobox-data">
						<span class="infobox-data-number"><%= dashboard["q_answered"] %></span>
						<div class="infobox-content">survey answered</div>
					</div>
				</div>

				<div class="infobox infobox-pink">
					<div class="infobox-icon">
						<i class="icon-comment"></i>
					</div>

					<div class="infobox-data">
						<span class="infobox-data-number"><%= dashboard["r_sent"]%></span>
						<div class="infobox-content">report sent</div>
					</div>
					
				</div>
				<div class="infobox infobox-green2">
					<div class="infobox-icon">
						<i class="icon-comment"></i>
					</div>

					<div class="infobox-data">
						<span class="infobox-data-number"><%=dashboard["active"][0].active_count %></span>
						<div class="infobox-content">active user</div>
					</div>
					
				</div>
				<div class="space-6"></div>

				
			</div>
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div>
	</div>
	<div class="hr hr32 hr-dotted"></div>				
	<div class="row">
		<div class="col-sm-12" >
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter">
						<i class="icon-signal"></i>
						App Penetration
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main padding-4">
						<div id="sales-charts"></div>
						
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div>								
	</div>
	<div class="row">
		<div class="col-sm-12" >
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter orange">
						<i class="icon-user"></i>
						Number of messages*users involved
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main padding-4">
						<div id="hriv-charts"></div>
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div>								
	</div>
	<div class="row">
		<div class="col-sm-12" >
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter green">
						<i class="icon-file"></i>
						HR Activity
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main padding-4">
						<div id="hract-charts"></div>
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div>								
	</div>
	<div class="row">
		<div class="col-sm-12" >
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter">
						<i class="icon-question"></i>
						Survery Answered with Percentage(%)
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main padding-4">
						<div id="svqa-charts"></div>
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div>								
	</div>
	<div class="row">
		<div class="col-sm-12" >
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter pink">
						<i class="icon-user"></i>
						User Activity
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main padding-4">
						<div id="ua-charts"></div>
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div>								
	</div>

	<div class="row">
		<div class="space-6"></div>

		<div class="col-sm-5">
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter">
						<i class="icon-star orange"></i>
						Top 10 Users
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main no-padding">
						<table class="table table-bordered table-striped">
							<thead class="thin-border-bottom">
								<tr>
									<th>
										<i class="icon-caret-right blue"></i>
										Name
									</th>

									<th>
										<i class="icon-caret-right blue"></i>
										Biz Sector
									</th>
									<th>
										<i class="icon-caret-right blue"></i>
										Department
									</th>
									<th class="hidden-480">
										<i class="icon-caret-right blue"></i>
										Point
									</th>
								</tr>
							</thead>
							<tbody>
								<% if(dashboard["top10"].length >0){
									for(var i=0;i<dashboard["top10"].length;i++)
									{
								%>
									<tr>
										<td><%=dashboard["top10"][i].name %></td>

										<td class="hidden-480">
											<%=dashboard["top10"][i].biz_sector %>
										</td>
										<td class="hidden-480">
											<%=dashboard["top10"][i].department %>
										</td>
										<td >
											<%=dashboard["top10"][i].point %>
										</td>
									</tr>
								<%
									}
								%>
									
								<% } %>
								
							</tbody>
						</table>
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div>

		<div class="vspace-sm"></div>

		<div class="col-sm-6">
			<div class="widget-box transparent">
				<div class="widget-header widget-header-flat">
					<h4 class="lighter">
						<i class="icon-star red"></i>
						Top 3 Users
					</h4>

					<div class="widget-toolbar">
						<a href="#" data-action="collapse">
							<i class="icon-chevron-up"></i>
						</a>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main no-padding">
						<div class="col-sm-12">
			<div class="widget-box">
				<div class="widget-header widget-header-flat widget-header-small">
					<h5>
						<i class="icon-signal"></i>
						Per Biz Sector
					</h5>

					<div class="widget-toolbar no-border">
						<button class="btn btn-minier btn-primary dropdown-toggle" data-toggle="dropdown" >
							<span id="btnbiz"><%= dashboard["biz_sector"][0].name%></span>
							<i class="icon-angle-down icon-on-right bigger-110"></i>
						</button>

						<ul class="dropdown-menu pull-right dropdown-125 dropdown-lighter dropdown-caret">
							<% if(dashboard["biz_sector"].length >0){
									for(var i=0;i<dashboard["biz_sector"].length;i++)
									{
								%>
									<li class="bz_sec <%= i==0?"active":"" %>" data-bizname = "<%= dashboard["biz_sector"][i].name %>">
										<a href="#" class="<%= i==0?"blue":"" %>">
											<i class="icon-caret-right bigger-110">&nbsp;</i>
											<%= dashboard["biz_sector"][i].name %>
										</a>
									</li>
								<%
									}
								%>
									
							<% } %>
							
						</ul>
					</div>
				</div>

				<div class="widget-body">
					<div class="widget-main">
						<table class="table table-bordered table-striped">
							<thead class="thin-border-bottom">
								<tr>
									<th>
										<i class="icon-caret-right blue"></i>
										Name
									</th>

									<th>
										<i class="icon-caret-right blue"></i>
										Biz Sector
									</th>
									<th>
										<i class="icon-caret-right blue"></i>
										Department
									</th>
									<th class="hidden-480">
										<i class="icon-caret-right blue"></i>
										Point
									</th>
								</tr>
							</thead>

							<tbody id="top3">
								<% if(dashboard["top3"].length >0){
									for(var i=0;i<dashboard["top3"].length;i++)
									{
								%>
									<tr>
										<td><%=dashboard["top3"][i].name %></td>

										<td class="hidden-480">
											<%=dashboard["top3"][i].biz_sector %>
										</td>
										<td class="hidden-480">
											<%=dashboard["top3"][i].department %>
										</td>
										<td >
											<%=dashboard["top3"][i].point %>
										</td>
									</tr>
								<%
									}
								%>
									
								<% } %>


							</tbody>
						</table>
					</div><!-- /widget-main -->
				</div><!-- /widget-body -->
			</div><!-- /widget-box -->
		</div><!-- /span -->
												</div><!-- /widget-main -->
											</div><!-- /widget-body -->
										</div><!-- /widget-box -->
									</div>
	</div><!-- /row -->
	<div class="hr hr32 hr-dotted"></div>
	</div>	<!-- PAGE CONTENT ENDS -->
			

<!-- page specific plugin scripts -->

<!--[if lte IE 8]>
  <script src="assets/js/excanvas.min.js"></script>
<![endif]-->
<script src="/assets/js/jquery.easy-pie-chart.min.js"></script>
<script src="/morris/raphael-min.js"></script>
<script src="/morris/morris.js"></script>
<script>

$(document).ready(function(){

$('.easy-pie-chart.percentage').each(function(){
		var $box = $(this).closest('.infobox');
		var barColor = $(this).data('color') || (!$box.hasClass('infobox-dark') ? $box.css('color') : 'rgba(255,255,255,0.95)');
		var trackColor = barColor == 'rgba(255,255,255,0.95)' ? 'rgba(255,255,255,0.25)' : '#E2E2E2';
		var size = parseInt($(this).data('size')) || 50;
		$(this).easyPieChart({
			barColor: barColor,
			trackColor: trackColor,
			scaleColor: false,
			lineCap: 'butt',
			lineWidth: parseInt(size/10),
			animate: /msie\s*(8|7|6)/.test(navigator.userAgent.toLowerCase()) ? false : 1000,
			size: size
		});
	});
	if ($('#sales-charts').length > 0){
		Morris.Line({
		  element: 'sales-charts',
		  data: <%- JSON.stringify(dashboard["appresult"]) %>,
		  xkey: 'show_date',
		  ykeys: ['installed_count','active_count'],
		  labels: ['number of installations','number of active users'],
		  parseTime: false,
		  xLabelAngle: 0,
		  lineColors:['blue','green'],
		  resize:true
		});	
	}
	if ($('#hriv-charts').length > 0){
		Morris.Line({
		  element: 'hriv-charts',
		  data: <%- JSON.stringify(dashboard["hr_chart"]) %>,
		  xkey: 'show_date',
		  ykeys: ['hr_user_involved'],
		  labels: ['number of hr_user_involved'],
		  parseTime: false,
		  xLabelAngle: 0,
		  lineColors:['#F9A882'],
		  resize:true
		});
	}
	if ($('#hract-charts').length > 0){
		Morris.Line({
		  element: 'hract-charts',
		  data: <%- JSON.stringify(dashboard["hr_chart"]) %>,
		  xkey: 'show_date',
		  ykeys: ['hr_message_sent','hr_survey_sent'],
		  labels: ['number of hr_message_sent','number of hr_survey_sent'],
		  parseTime: false,
		  xLabelAngle: 0,
		  lineColors:['#AECA5B','#8CC2E6'],
		  resize:true
		});
	}



	if ($('#svqa-charts').length > 0){
		Morris.Line({
		  element: 'svqa-charts',
		  data: <%- JSON.stringify(dashboard["hr_qa"]) %>,
		  xkey: 'show_date',
		  ykeys: ['answered_percentage'],
		  labels: ['number of survey_answered'],
		  parseTime: false,
		  xLabelAngle: 0,
		  lineColors:['#3A83C2'],
		  resize:true
		});		
	}
	if ($('#svqa-charts').length > 0){
		Morris.Line({
		  element: 'ua-charts',
		  data: <%- JSON.stringify(dashboard["us_ac"]) %>,
		  xkey: 'show_date',
		  ykeys: ['report_sent'],
		  labels: ['number of report_sent'],
		  parseTime: false,
		  xLabelAngle: 0,
		  lineColors:['#D68CDF'],
		  resize:true
		});
	}
 
$(".bz_sec").click(function(e){
	e.preventDefault();
	$(".bz_sec").removeClass("active");
	$(".bz_sec a").removeClass("blue");
	$(this).addClass("active");
	$(this).find('a').addClass("blue");
	$("#btnbiz").html($(this).attr("data-bizname"));
	$.ajax({
	  method: "POST",
	  url: "/admin/dashboard/gettop3",
	  data: { biz_sector:$(this).attr("data-bizname") }
	})
  .done(function( data ) {
	var top3data = "";
    if(data.result.length>0)
	{
		
		for(var i=0;i<data.result.length;i++)
		{
			top3data +="<tr><td>"+data.result[i].name +"</td><td class='hidden-480'>"+data.result[i].biz_sector+"</td><td class='hidden-480'>"+data.result[i].department+"</td><td >"+data.result[i].point+"</td></tr>";
		
		}
		$("#top3").html(top3data);													
															
	}
	else
	{
		$("#top3").html(top3data);	
	}
	
  });
							
});
   
});

</script>
		